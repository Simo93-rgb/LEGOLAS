]633;E;uv run python -m src.explainability.extract_explainability --model bert-base-uncased --format narrativo --dataset valvole_cardiache --top_k 10 --internal_batch_size 32 --n_steps 1500 --adaptive_steps --device cuda;c1175fa7-e617-4c4d-b843-e9708568c2ac]633;C================================================================================
  LEGOLAS - Explainability Extraction (Integrated Gradients)
================================================================================

ğŸ“‹ Configuration:
   Model: bert-base-uncased
   Format: narrativo
   Dataset: valvole_cardiache
   Device: cuda
   Mode: Best fold only
   Top-K: 10
   Internal batch size: 32 (for IG interpolation)
   IG steps: Adaptive (1500â†’5500 if needed, tolerance=0.05)
ğŸ“– Loading data (format: narrativo, dataset: valvole_cardiache)...
   âœ… Loaded 119 valvole_cardiache samples
   ğŸ“Š Label mapping: {0: 0, 1: 1}

   ğŸ“ˆ Class distribution:
      Class 0: 114 samples (95.8%)
      Class 1: 5 samples (4.2%)

   ğŸ“Š Dataset: 119 samples, 2 classes

ğŸ¤– Loading model: bert-base-uncased
   Story format: narrativo
   Mode: Best fold only
ğŸ“‹ Model architecture from checkpoint: bert-base-uncased
âœ… HuggingFace ID: bert-base-uncased

ğŸ“¥ Loading best fold model...
   Best fold: 0
   Accuracy: 0.9361
   Model: best_model_narrativo_bert-base-uncased_fold0.pth
   Deduced config: hidden_size=768, vocab_size=30522, layers=12, heads=12
   âœ… Model loaded successfully

   HuggingFace ID: bert-base-uncased
   âœ… Model loaded successfully
   ğŸ“Š Single model: best fold


ğŸ”® Generating predictions...
   âœ… Predictions completed

   ğŸ“Š Predicted distribution:
      Class 0: 112 samples
      Class 1: 7 samples

   ğŸ¯ Accuracy: 94.96% (113/119)

================================================================================

================================================================================
ğŸ” Computing Integrated Gradients...

ğŸ”„ Pre-tokenizing 119 sequences (CPU)...
   Tokenizing:   0%|          | 0/119 [00:00<?, ?sample/s]   Tokenizing:   5%|â–Œ         | 6/119 [00:00<00:02, 52.50sample/s]   Tokenizing:  10%|â–ˆ         | 12/119 [00:00<00:02, 52.15sample/s]   Tokenizing:  15%|â–ˆâ–Œ        | 18/119 [00:00<00:01, 50.67sample/s]   Tokenizing:  20%|â–ˆâ–ˆ        | 24/119 [00:00<00:01, 48.76sample/s]   Tokenizing:  24%|â–ˆâ–ˆâ–       | 29/119 [00:00<00:01, 48.11sample/s]   Tokenizing:  29%|â–ˆâ–ˆâ–Š       | 34/119 [00:00<00:01, 46.89sample/s]   Tokenizing:  33%|â–ˆâ–ˆâ–ˆâ–      | 39/119 [00:00<00:01, 46.11sample/s]   Tokenizing:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 45/119 [00:00<00:01, 47.56sample/s]   Tokenizing:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 51/119 [00:01<00:01, 48.53sample/s]   Tokenizing:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 56/119 [00:01<00:01, 48.87sample/s]   Tokenizing:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 61/119 [00:01<00:01, 48.93sample/s]   Tokenizing:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 66/119 [00:01<00:01, 48.12sample/s]   Tokenizing:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 71/119 [00:01<00:00, 48.51sample/s]   Tokenizing:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 77/119 [00:01<00:00, 49.01sample/s]   Tokenizing:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 82/119 [00:01<00:00, 49.23sample/s]   Tokenizing:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 87/119 [00:01<00:00, 48.06sample/s]   Tokenizing:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 92/119 [00:01<00:00, 45.33sample/s]   Tokenizing:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 97/119 [00:02<00:00, 45.33sample/s]   Tokenizing:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 102/119 [00:02<00:00, 44.03sample/s]   Tokenizing:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 107/119 [00:02<00:00, 44.75sample/s]   Tokenizing:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 112/119 [00:02<00:00, 44.34sample/s]   Tokenizing:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 117/119 [00:02<00:00, 42.80sample/s]                                                                       âœ… Pre-tokenization done
   Computing IG:   0%|          | 0/119 [00:00<?, ?sample/s]   Computing IG:   1%|          | 1/119 [00:11<22:29, 11.44s/sample]   Computing IG:   2%|â–         | 2/119 [00:21<21:09, 10.85s/sample]   Computing IG:   3%|â–         | 3/119 [01:14<58:14, 30.13s/sample]   Computing IG:   3%|â–         | 4/119 [01:26<43:22, 22.63s/sample]   Computing IG:   4%|â–         | 5/119 [01:38<35:44, 18.81s/sample]   Computing IG:   5%|â–Œ         | 6/119 [01:49<30:37, 16.26s/sample]   Computing IG:   6%|â–Œ         | 7/119 [01:59<26:31, 14.21s/sample]   Computing IG:   7%|â–‹         | 8/119 [02:10<24:17, 13.13s/sample]   Computing IG:   8%|â–Š         | 9/119 [02:21<22:45, 12.42s/sample]   Computing IG:   8%|â–Š         | 10/119 [02:30<21:07, 11.63s/sample]   Computing IG:   9%|â–‰         | 11/119 [02:41<20:25, 11.35s/sample]   Computing IG:  10%|â–ˆ         | 12/119 [02:52<19:54, 11.17s/sample]   Computing IG:  11%|â–ˆ         | 13/119 [03:02<19:01, 10.77s/sample]   Computing IG:  12%|â–ˆâ–        | 14/119 [03:13<18:50, 10.77s/sample]   Computing IG:  13%|â–ˆâ–        | 15/119 [03:23<18:37, 10.75s/sample]   Computing IG:  13%|â–ˆâ–        | 16/119 [03:33<17:59, 10.48s/sample]   Computing IG:  14%|â–ˆâ–        | 17/119 [03:44<17:59, 10.58s/sample]   Computing IG:  15%|â–ˆâ–Œ        | 18/119 [04:32<36:44, 21.83s/sample]   Computing IG:  16%|â–ˆâ–Œ        | 19/119 [04:43<30:50, 18.50s/sample]   Computing IG:  17%|â–ˆâ–‹        | 20/119 [04:53<26:42, 16.18s/sample]   Computing IG:  18%|â–ˆâ–Š        | 21/119 [05:03<23:21, 14.30s/sample]   Computing IG:  18%|â–ˆâ–Š        | 22/119 [05:14<21:24, 13.24s/sample]   Computing IG:  19%|â–ˆâ–‰        | 23/119 [05:25<19:59, 12.49s/sample]   Computing IG:  20%|â–ˆâ–ˆ        | 24/119 [05:35<18:32, 11.71s/sample]   Computing IG:  21%|â–ˆâ–ˆ        | 25/119 [05:46<17:54, 11.44s/sample]   Computing IG:  22%|â–ˆâ–ˆâ–       | 26/119 [05:56<17:24, 11.23s/sample]   Computing IG:  23%|â–ˆâ–ˆâ–       | 27/119 [06:06<16:33, 10.80s/sample]   Computing IG:  24%|â–ˆâ–ˆâ–       | 28/119 [06:17<16:20, 10.77s/sample]   Computing IG:  24%|â–ˆâ–ˆâ–       | 29/119 [06:28<16:10, 10.79s/sample]   Computing IG:  25%|â–ˆâ–ˆâ–Œ       | 30/119 [06:38<15:37, 10.53s/sample]   Computing IG:  26%|â–ˆâ–ˆâ–Œ       | 31/119 [06:48<15:34, 10.62s/sample]   Computing IG:  27%|â–ˆâ–ˆâ–‹       | 32/119 [06:59<15:26, 10.65s/sample]   Computing IG:  28%|â–ˆâ–ˆâ–Š       | 33/119 [07:47<31:16, 21.82s/sample]   Computing IG:  29%|â–ˆâ–ˆâ–Š       | 34/119 [07:58<26:12, 18.50s/sample]   Computing IG:  29%|â–ˆâ–ˆâ–‰       | 35/119 [08:46<38:17, 27.35s/sample]   Computing IG:  30%|â–ˆâ–ˆâ–ˆ       | 36/119 [08:57<30:57, 22.38s/sample]   Computing IG:  31%|â–ˆâ–ˆâ–ˆ       | 37/119 [09:44<40:57, 29.97s/sample]   Computing IG:  32%|â–ˆâ–ˆâ–ˆâ–      | 38/119 [09:55<32:40, 24.20s/sample]   Computing IG:  33%|â–ˆâ–ˆâ–ˆâ–      | 39/119 [10:06<26:55, 20.19s/sample]   Computing IG:  34%|â–ˆâ–ˆâ–ˆâ–      | 40/119 [10:16<22:38, 17.19s/sample]   Computing IG:  34%|â–ˆâ–ˆâ–ˆâ–      | 41/119 [10:27<19:55, 15.33s/sample]   Computing IG:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 42/119 [10:38<17:52, 13.93s/sample]   Computing IG:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 43/119 [10:48<16:08, 12.74s/sample]   Computing IG:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 44/119 [11:37<29:34, 23.66s/sample]   Computing IG:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 45/119 [11:47<24:09, 19.59s/sample]   Computing IG:  39%|â–ˆâ–ˆâ–ˆâ–Š      | 46/119 [11:58<20:46, 17.07s/sample]   Computing IG:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 47/119 [12:09<18:15, 15.22s/sample]   Computing IG:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 48/119 [12:19<16:10, 13.66s/sample]   Computing IG:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 49/119 [12:30<15:05, 12.93s/sample]                                                                        Computing IG:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 49/119 [12:41<15:05, 12.93s/sample]   Computing IG:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 50/119 [12:41<14:16, 12.41s/sample]   Computing IG:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 51/119 [12:52<13:18, 11.74s/sample]   Computing IG:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 52/119 [13:02<12:49, 11.48s/sample]   Computing IG:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 53/119 [13:13<12:25, 11.30s/sample]   Computing IG:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 54/119 [13:23<11:49, 10.92s/sample]   Computing IG:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 55/119 [13:34<11:38, 10.91s/sample]   Computing IG:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 56/119 [13:45<11:25, 10.88s/sample]   Computing IG:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 57/119 [13:55<10:58, 10.62s/sample]   Computing IG:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 58/119 [14:06<10:52, 10.69s/sample]